<dom-module id="user-info">

  <style type="text/css">
    .userData {
      padding: 1em;
      margin: 1em;
    }

    #user-image {
      text-align: center;
      border-radius: 100%;
      width: 50px;
      height: 50px;
      position: relative;
    }
  </style>
  <template>
    <firebase-document id="getUserFB" location="[[computeFbHref(empid)]]" data="{{user}}"></firebase-document>
    <paper-material class="userData" id="[[empid]]">
      <img src={{computeProfilePic(user)}} id="user-image">
      <span>{{computeFullName(user)}}</span>
    </paper-material>
    <section class="layout horizontal wrap">
      <template is="dom-repeat" items="[[computeAssetHistory(user)]]" as="asset" id="assetList">
        <asset-info assetid="[[asset.assetId]]"></asset-info>
      </template>
    </section>
  </template>

  <script>
    Polymer({
      is: 'user-info',
      properties: {
        empid: Number
      },
      computeFbHref: function(empId) {
        return app.env.db.users + empId;
      },
      computeFullName: function(user) {
        return (user) ? (user.firstName + ' ' + user.lastName) : '';
      },
      computeProfilePic: function(user) {
        return (user) ? user.picture : app.defaultAvatar;
      },
      computeAssetHistory: function(user) {
        var obj = (user) ? user.assets : null;
        var arr = [];
        if (obj) {
          arr = Object.keys(obj).map(function(k) {
            return obj[k];
          });
        }
        return arr;
      }
    });
  </script>
</dom-module>
